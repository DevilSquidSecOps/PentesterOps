
## Updating

###### Commands used to update or upgrade 
    apt-get update
    apt dist-upgrade #Reboot 
    apt install kali-linux-all #Reboot
    apt autoclean
    apt autoremove
    apt --fix-broken install


## Setup

## XRDP
**HOW TO INSTALL XRDP FOR AN RDP SESSION FOR FULL SCREEN STUFF**
> apt-get update 

> apt-get upgrade 

> apt-get install xrdp 

> Service xrdp start
> Service xrdp-sesman start  

**If want it to auto start after reboot you need to run this command also:**

> update-rc.d xrdp enable     (It will not start xrdp-sesman automatic)

**If Errors occur:** 
> Apt-get remove gnome-core

> apt-get install lxde-core lxde kali-defaults kali-root-login desktop-base (for ubuntu instead: "apt-get 
install lxde" "sudo apt install lxde-common" >logout and choose the little icon at login screen for change to LXDE)

> update-alternatives â€“config x-session-manager (For ubuntu 16 "echo lxsession -s LXDE -e LXDE > ~/.xsession" --  makes it accessible from RDP now)

Choose /usr/bin/startlxde


ref: https://msitpros.com/?p=3209

### KeyBoard Shorcuts in LXDE environment
   ###### locate the lxde shortcuts for the keyboard xml file
       ps ax | grep openbox
    ###### Edit the file with the terminal you want to run under keyboards section
          nano  ~/.config/openbox/lxde-rc.xml
   ######  Add these lines:
       <!-- Launch LXTerminal with Ctrl+Alt+t-->
    <keybind key="C-A-t">
      <action name="Execute">
        <command>lxterminal</command>
      </action>
    </keybind>
##### Reconfigure or restart the service if needed
    openbox --reconfigure
    openbox --restart


```python

```

##### Connecting
    ip: 10.10.40.201
    RDP enabled
    un/pw: root/networkpass


```python
"""Update periodically as needed"""
# !apt-get update
"""run this if you receive an invalid key error or repository issue during apt-get update"""
# !wget -q -O - https://archive.kali.org/archive-key.asc  | apt-key add
```




    'run this if you receive an invalid key error or repository issue'



### Installing Jupyter Notebook
    installing anaconda: https://jupyterhub.readthedocs.io/en/0.7.0/quickstart.html

    a. go here: https://www.anaconda.com/download/#linux and copy the linux 
    link for the installer and use wget to download it to your linux folder


 > wget https://repo.continuum.io/archive/Anaconda3-5.1.0-Linux-x86_64.sh
 > bash <anacondainstallerfile.sh>

            Note: if installed without making the anaconda your path 
            variable follow this to make it a path variable https://docs.anaconda.com/anaconda/faq#distribution-faq-linux-path
            
###### Installing anaconda alone will give you jupyter notebook

# install a new environment by cloning 
> conda create -n myownenv --clone root

**Activate the env kernel**
> source activate myownenv; ipython kernel install --user --name myownenv

# SSH/SCP Server

* "/etc/ssh/ssh_config" - Client Configuration

**Verify SSH service installed**

**Install/Start SSH Service if needed**

    >sudo apt-get install openssh-server
    OR apt-get install ssh
    >sudo /etc/init.d/ssh start

**Allow ROOT login for the Root user**

    >nano /etc/ssh/sshd_config
    >>> add/uncomment following line: PermitRootLogin yes

### SCP to Unix Machine with SSH enabled
* enter the file to transfer username@host or IP:directory on the remote box
    > sudo scp openvpnfiles.zip root@10.10.40.201:/root/
    
    > scp alpine-v3.9-i386-20190216_0135.tar.gz  xalvas@10.10.10.27:

### Transfer Files Using SCP To Windows Box(SSH needs to be installed on Kali)

###### Verify scp package is installed on Kali
       dpkg -L openssh-client | grep scp
        /usr/bin/scp
        /usr/share/man/man1/scp.1.gz
##### Verify pscp Putty SCP package is installed on Windows(should already install with Putty)
    https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html 
    >pscp 
    OR
    >Use WinSCP and connect to kali box with root@10.10.40.201 as the ssh username/pw to use
 ###### If you get a connection refused from the windows box > linux box start the ssh server(see above)
 
    

## Generate Public Keys
* use ssh-keygen and specify params as needed it will save to /root/.ssh/
* -b for bit strength
* -t for public key crypto type(rsa,dsa)

> ssh-keygen -b 1024 -t rsa


### Force PublicKey Authentication
* https://unix.stackexchange.com/questions/15138/how-to-force-ssh-client-to-use-only-password-auth
> ssh -o PreferredAuthentications=publickey -o PubkeyAuthentication=no example.com

### Specify Algos and Ciphers
* do this if you get errors just run the switches and include what you see in the errors
* cipher error "no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,arcfour,aes192-cbc,aes256-cbc,rijndael-cbc@lysator.liu.se
* no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1 

> ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -c 'aes128-cbc' bob@10.11.1.115 

# Connect to OSCP or any OPENVPN Node
    See "PIA-VPN" notebook for connection notes/commands
  ### Bash Script to start open vpn connection to OSCP lab
      nano startVPN ----------use this to open a text editor to create the file
          Enter information in Cell below
#!/bin/bash
sudo openvpn --config '/root/Desktop/OSCP Materials/OS-35514-PWK.ovpn' --auth-user-pass '/root/Desktop/OSCP Materials/login.txt' #SET PERMISSIONS
 chmod u+x /root/Desktop/OSCP Materials/startVPN
###### Run the script and connect to the openvpn node(has to be done inside a shell)
    ./startvpn

# Install Latest Firefox version
    download latest build: https://www.mozilla.org/en-US/firefox/new/?utm_medium=referral&utm_source=getfirefox-com 
    unzip it with right click option and take note of its location or put somewhere you know
### Need to point to this new version
###### Backup old version
    mv /usr/lib/firefox-esr/firefox-esr /usr/lib/firefox-esr/firefox-esr_orig
###### insert new symlink for new version
    ln -s /root/Downloads/FireFox60/firefox/firefox /usr/lib/firefox-esr/firefox-esr
###### verify new version launches by using alt when opeining firefox and using the help/about page 
    selenium firefox driver should now function correctly/fix the blank page when requestion a website

# HTTP Server
    Used to host files and possibly have victim machines connect to it
###### Start/stop Apache web server
    service apache2 start
    service apache2 stop

# FTP Client
    apt-get install ftp

# IP/DNS/Networking

# Find DNS and other network config with this command on my Kali box(specify adapter ie;eth0)
> nmcli device show eth0
GENERAL.DEVICE:                         eth0
GENERAL.TYPE:                           ethernet
GENERAL.HWADDR:                         00:0C:29:36:57:69
GENERAL.MTU:                            1500
GENERAL.STATE:                          100 (connected)
GENERAL.CONNECTION:                     Ifupdown (eth0)
GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/3
WIRED-PROPERTIES.CARRIER:               on
IP4.ADDRESS[1]:                         192.168.1.78/24
IP4.GATEWAY:                            192.168.1.25
IP4.DNS[1]:                             192.168.1.25
IP4.DOMAIN[1]:                          poisedcreatures.com
IP6.ADDRESS[1]:                         fe80::ce10:3f8:8c3c:c5b6/64
IP6.GATEWAY:                            --


```python

```

# TMUX
    Use this to pane my command windows for better workflow.
    Good when pentesting and you need to re-run commands you can always have some small paned bash prompt open to re-run through the history of commands that let you exploit and you can do this with multiple windows.
    no need to tab through all my shells and accidently close the master and lose it all and have to restart
* Guides
    https://www.perl.com/article/an-introduction-to-tmux/
    https://gist.github.com/henrik/1967800

**.tmux.conf file**
* use to edit bindings and add plugins. Created from the example config in usr/share 
* ~/.tmux.conf

**See current config**
> tmux show-options -g

**Reload Config**
> tmux source ~/.tmux.conf

**Plugins**
* installed plugin manager https://github.com/tmux-plugins/tpm 
* installed tmux logging https://github.com/tmux-plugins/tmux-logging
* installed tmux pane control https://github.com/tmux-plugins/tmux-pain-control
* installed tmux save/restore https://github.com/tmux-plugins/tmux-resurrect

**Commands**
* tmux: type this in a shell and it will turn into a TMUX window
* CTRL-B: prefix for the commands also known as bind-key

**Save/Restore Session after restart**
> prefix + Ctrl-s - save

> prefix + Ctrl-r - restore

**Windows**

    w: brings up the windows menu and you can cycle through and see all open windows and embedded panes
    &: kills windows if selected using "w" or a selected pane
    c: new window
    $: rename a session
    ,: rename Window
    
**Panes**
> ": splits a new window Horizontally

> %: splits a  new window Vertically

> esc+1-5: known as M-1 - M-4; Use it to cycle through or use the preset pane arrangements

> spacebar: also cycles through the pane presets consecutively

> x : kill pnae

> z : maximize a pane for better view. CTRL + B + Z again to normalize again

**Move pane to window 1 or name of window**
> ":" + joinp -t :1 

**Scrolling**
  
* [: use this to go into scroll mode if needed. good to keep a vertical window for this sort of space needed

**Copying text from a paned window**
   
* ctrl+b+z to maximize window and copy as needed
    
**Copy log of all output within a pane**
* ctrl+b+alt+shift+P this will copy all pane output linesto ~/tmux=history-x-x-x-x for loggin and documentation purposes

**Copy From set point to end of buffer**
* useful when i cat a file in reverse shell and want to copy it but it's a lot of lines

* Get in Scroll mode
> ctrl+b+[ 

* search for the command text tostart the copy from
> ctrl+s 

* enter copy mode
> ctrl+space

*select to the end of the buffer
> ALT+shift+> 

* copy to tmux clipboard(can then insert into a vi file)
> ctrl+w

> vi myfile.txt 

* insert into my file

> ctrl+b+]

**Search all text in a Pane**
* get in scroll mode then search
>  ctrl+b+[  > ctrl+s   :enter search text at bottom

**Sync all panes**
* Use "off" to stop this i did this on accident

> Ctrl-B :

> setw synchronize-panes on

# Set Environment Variable for .py Script
    PATH environment variables are loaded from ~/.bashrc shell script

**Quick method for pentesting**
* copy the original path env var
> echo \$PATH

> PATH=<path/to/dir>:<copied original path\> 

* Finally write it to the environmental vars used for the user
> export PATH

## Permanent 1
##### Read PATH env Then copy to existing location For permanent add
    echo $PATH
 ##### Copying the smbserver.py script into an existing PATH location
     cp /usr/share/doc/python-impacket/examples/smbserver.py smbserver.py

  
 
#####  Add to the PATH variable this location to run the smbserver.py script for example
        >PATH=/root/anaconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/share/doc/


## Permanent 2
##### Add directory to my script to the ~/.bashrc file
    to add my /root/scripts directory to:
    ie: nano ~/.bashrc
        # added by Anaconda3 installer
        export PATH="/root/anaconda3/bin:$PATH"---------------------we should see this line added by anaconda
     export PATH="/root/scripts:$PATH"  ----------------------------------------------we simply add this line at the end
        
#### Reload the bashrc file(this would have to be done by each window/pane your working in)
      . ~/.bashrc
###### ref: https://unix.stackexchange.com/questions/3809/how-can-i-make-a-program-executable-from-everywhere 


 ## Temporary
 ##### METHOD2 Temporary add
##### Export The new variable and run smbserver.py without calling it's path
    >PATH=/root/anaconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/share/doc/python-impacket/examples
    >export PATH
    >echo $PATH
/root/anaconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/share/doc/python-impacket/examples
    >smbserver.py
        Impacket v0.9.15 - Copyright 2002-2016 Core Security Technologies............................................

# Rdesktop
    Used to connect to port 3389 on windows machines like RDP basically for linux
###### Connect in full screen mode
    rdesktop -u offsec -p FGnm4jh9KZv 10.11.11.29 -f
###### Escape full screen mode
    CTRL + ALT + ENTER 

# Searching(locate/which/find)
### Locate
    uses and indexed database that needs to be periodically updated using "updatedb" command

### Find
* "-type f" will search for files
*  "-o" OR operator
* "/" starts at the root directory for the search
* "!" is NOT operator
* "-path" select a path to search in used with type -f operator
* "\\(" parenthesis must be escaped
find / -type f \( -iname \*proof.txt -o -iname \*network-secret* \)find /var/www/ ! -name '*.js' -type f  | xargs grep -in \$mysql
* starting at root dir Skip .js and .php files and skip directrories listed and grep for non Binary files for the phrase password for 20 chars before and after
find / -type f \( ! -iname \*.js -o -iname \*.php \) ! -path "/var/*" ! -path "/usr/*" ! -path "/proc/*" | xargs grep -iInoP ".{0,20}password.{0,20}"
**Find all ssh key files and copy to cwd**
* you must enter the last "\\;" when calling copy directly this works the best when you only have sudo since piping to xargs you would have to sudo again
find /etc -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa -o -iname \*dsa*key -o -iname \*rsa*key -o -iname \*ssh*host* \) | xargs -I {} cp {} ./sudo find /etc -type f \( -iname \*.pub -o -iname \*id_dsa* -o -iname \*id_rsa -o -iname \*dsa*key -o -iname \*rsa*key -o -iname \*ssh*host* \) -exec cp {} ./ \;
# Run scripts using different Python envs
* Add this to the top of your script referncing the python engine in the env for the "AutoBrowsing" env
> #!/home/sbracamonte/anaconda3/envs/AutoBrowsing/bin/python

> #!/root/anaconda3/envs/ipykernel_py2/bin/python


```python
#List your envs to use within the scripts
!conda info --envs
```

    # conda environments:
    #
    base                  *  /home/sbracamonte/anaconda3
    AutoBrowsing             /home/sbracamonte/anaconda3/envs/AutoBrowsing
    myownenv                 /home/sbracamonte/anaconda3/envs/myownenv
    py27                     /home/sbracamonte/anaconda3/envs/py27
    


# Write scripts directly from Jupyter to file location
* add this to the very top of a cell containing all the code
> %%writefile /root/scripts/SLmail-BO.py

* Windows
> %%writefile c:\\temp\\test.py


# Firewall/Iptables
###### View rules and hits 
    iptables -vn -L
###### Allow conns from an IP
    iptables -I INPUT 1 -s 10.0.0.19 -j ACCEPT
###### Allow only 443 from an IP and put in 1st rules to be filtered position
    iptables -I INPUT 1 -p tcp --dport 443 -s 10.11.11.29 -j ACCEPT
######    Export config
    iptables-save > (enter output file)
##### Delete rule by line number, first find line numbers then delete the one you want
    iptables -L --line-numbers # displaying lines
    iptables -D INPUT 2 # deleting line 2

# SymLinks/Mounts
    a mount will allow ftp server to connect to a different part of the system a symlink won't
###### Create symlink to the project folder in /var/www/html(this is the symlink)
   * ln -s /home/user/project /var/www/html
   


```python

```

### Net Only (Authenticating with User Creds to  a Domain)
* Use the Net Only command with the domain/user params to authenticate and try to enumerate things against a given domain
* on HTB remember to first disconnect your  vpn on kali and recconnect via windows box. 
* install the openvpn EXE file if you need to and can just just my openvpn HTB connection file

**Opening a cmd prompt as a domain user**
> runas /netonly /user:active.htb\SVC_TGS cmd

**Verify creds work by listing share we know only the user could read**

> dir \\\10.10.10.100\Users

###### Create mount point to the "/var/www/dev/" directory in home directory
>  mkdir /home/ftp_user/www_dev

> mount --bind /var/www/dev/ /home/ftp_user/www_dev

* to remove a mounted bind

> umount /home/ftp_user/www_dev

> rmdir /home/ftp_user/www_dev

# Backgrounding
* use the ctrl + Z method to background a current command ie; netcat to continue another command without switching screens at all for workflow
 
    ref: https://www.tecmint.com/run-linux-command-process-in-background-detach-process/
  
**lists all backgrounded sessions**
> jobs
      
**Foreground Job 1**
> fg 1
 
**Background Job at onset of command**
> "ANY COMMAND" & 


**Background Job running in terminal**
> CTRL+Z

> bg

**removes all jobs from active list**
>disown

**Kill job ID 1**
>kill %1

**Kill job by proc name**
> pkill tcpdump


# Compressed files
* used to compress/decompress files before transferring them

**Zipping a folder**
    
> sudo zip -r openvpnfiles openvpn/

**Unzipping a zip file**

> unzip <file> 

    
**tar.bz2**
* decompress
 > tar jxvf lab-connection.tar.bz2
    
**.rar**

> unrar x ./Employees.rar
    
**tar.gz**
> tar -xvzf 9208.tar.gz

# Bash History
    us "history" command to view the last 1000+ commands ran to document something in a pentest you wanted to go back to etc
    using TMUX some of the panes might have their own histories

######  remove line numbers from history ouput
    history | cut -c 8-

# Powershell
* install powershell for linux Debian 9 https://docs.microsoft.com/en-us/powershell/scripting/setup/installing-powershell-core-on-linux?view=powershell-6

**Install system components**
>sudo apt-get update

> sudo apt-get install curl gnupg apt-transport-https

**Import the public repository GPG keys**

> curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -

**Register the Microsoft Product feed**
> sudo sh -c 'echo "deb [arch=amd64] https://packages.microsoft.com/repos/microsoft-debian-stretch-prod stretch > main" > /etc/apt/sources.list.d/microsoft.list'

**update the list of products**
> sudo apt-get update

**Install PowerShell**
> sudo apt-get install -y powershell

**Start PowerShell**
> pwsh

# BloodHound
* after install you will need to reset teh neo4j database password

> apt-get install bloodhound

>neo4j console
* take note of the url and open the http gui default pass is "neo4j" and change it
* exit the conosle and you can background this db
> neo4j start 

* start bloodhound

> cd /usr/lib/bloodhound/

> ./BloodHound

* login use ctrl+R to refresh in case it stays white screen
* use upload data button to upload your exported zip files

# Time
* verify vmware isn't syncing the time automatically https://pubs.vmware.com/vsphere-50/index.jsp?topic=%2Fcom.vmware.vmtools.install.doc%2FGUID-C0D8326A-B6E7-4E61-8470-6C173FDDF656.html
* disable completely editing the .vmx file via ssh from my main desktop into the esxi host but may not be needed


> cd /user/bin 

> vmware-toolbox-cmd timesync status

**Checking ntp settings**
* verify not synced if you are trying to do the rdate command with another box or trying to set time manually
> timedatectl

**If enabled disable with**
> timedatectl set-ntp 0




# XCLIP 
* use to copy large file to clipboard immediately

> cat privesc.sh | xclip -selection clipboard


# PHP
* installing php curl package after getting this error:

* PHP Warning:  PHP Startup: Unable to load dynamic library 'curl' (tried: /usr/lib/php/20170718/curl (/usr/lib/php/20170718/curl: cannot open shared object file: No such
 file or directory), /usr/lib/php/20170718/curl.so (/usr/lib/php/20170718/curl.so: cannot open shared object file: No such file or directory)) in Unknown on line 0    
PHP Warning:  PHP Startup: Unable to load dynamic library 'curl.so' (tried: /usr/lib/php/20170718/curl.so (/usr/lib/php/20170718/curl.so: cannot open shared object file
: No such file or directory), /usr/lib/php/20170718/curl.so.so (/usr/lib/php/20170718/curl.so.so: cannot open shared object file: No such file or directory)) in Unknown
 on line 0 
 
* You can llist all installable php packages with a "apt-get install php" and tab to see what's a vailable but you run php7.2 by default and the curl package to install needs to be the same version

> apt-get install php7.2-curl

# Text Parsing Tools

### Grep
* -i for case insensitive search 
* -b for binary search. Good for grepping through web output from curl
* -c count number of matches only
* -f supply a list of search parameters

* to grep two different strings ie; "fire" and "data" escape the pipe and put the terms in quotes
> cat test.txt | grep -i -b "fire\\|data"

* grep before and after chars

> find / -type f \( ! -iname \*.js -o -iname \*.php \) ! -path "/var/*" ! -path "/usr/*" ! -path "/proc/*" | xargs grep -iInoP ".{0,20}password.{0,20}"

* grep before and after lines

> tcpdump -e -vv -nX -r cap1-5.pcap host 10.11.1.251 and port 10443 | grep -i -B 10 "nina"

**Grep for IPs**

> grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' /etc/hosts

**Grep through a given list of search parameters**
> grep -f test.txt mariobros.txt 

**xargs**
* -I '{}' means make a place holder for the argument being passed to be used in subsequent commands
* \$1 would choose the first argument 
* $@ would simply choose all arguments as if feeding it directly into the command 
* sh -c '<enter command\>' we can use sh -c to invoke a bash command inline with the argument being passed to do piping etc

* cat the vulners.nmap file, pass to awk to capture the 4th section contianing HTTP sites for vulners.com, grep only http sites, pass to xargs creating a place holder and using sh -c to curl and pipe to grep for the text we are looking for and then echo the argument being the website we are checking to know which to then investigate
> cat vulners.nmap | awk '{print $4}' | grep http | xargs -I '{}' sh -c 'curl -s {} | grep -i -b -c exploit-db.com && echo "{}"'

* unmatched single quote; error use printf ie;

> find ../ -type f -printf '"%p"\n' | xargs grep -inb cactus


**wc/sort**
* wordcount by characters and sort by numbers and reverse results. Good to sift through a large number of similar filee
> wc -c *.acc | sort -nr

*File Count*
> ls -l <directory\> | wc -l

**split**
* Split list into separate lists with 3 lines each of the input list
* first get the number of lines in your list and divide by the number of lists you want

> wc -l ALL_Unix.txt

> python -c "print(559222/4)"


> split -l 139806 input.txt output.txt

**tr**
* removes chars from a line i grep or otherwise
* removing parenthesis from nmap output for dns names
> cat DNS.nmap | tr -d '()'

* replaces chars ie; \\n chars to print in one line for python etc list building

> vi ports.txt 

> cat ports.txt | awk '{print $1}' | tr '\n' ',' | xclip -sel clip

**echo -e/printf**
* use these to read hex code with "\\"s into a string format

> printf  "\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x73\x79\x73"

> echo -e "\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x73\x79\x73"
                   
                   __import__('os').sys

### Awk
* -F is for setting a delimiter char to stop at
* '{print $1}' prints only the first value using spaces as delimiters
* /open/ on any line that has "open" in it
* {print $1} print the first field of that line ie; "22" if the line started with 22/open
* {print $NF":"$4} this would print the last field in the line followed by a colon and then the 4th field
* ORS="," this replaces the newline chars with a comma putting all ports from an nmap scan into one line separated by commas
* {print substr($1, 1, length($1)-1)} choose the line "$1, 1," and make it's length the line itself minus one char "length($1)-1)}"
* NF - removes empty lines from the specified file
**print only the hostname from "humble2.thinc.local"**

> cat dns.nmap | awk -F'.' '{print $1}' 

* Make list file comma separated

> awk '{print $1}' ORS="," ~/oscp/lab-net2019/passwords.txt

**extract ports form nmap normal scan output file and pipe into a new scan**
> awk -F" |/" '/open/ {print $1}' ORS="," scan.nmap | awk '{print substr($1, 1, length($1)-1)}' | xargs -I '{}' nmap -oN vulners.nmap-v -sV --version-intensity 9 -T2 --script vulners -p {} 10.10.10.11
**Get all uniq ips from text file**
awk '{match($0,/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/); ip = substr($0,RSTART,RLENGTH); print ip}' IPSa.txt | grep "." | uniq >> allIPs.txt
**Remove empty lines**
> awk 'NF {print $2}' mariobroslist.txt

**make all chars lowercase**
> awk '{ print tolower($0) }' luigi.txt 

### Nmap to csv
> pip install nmaptocsv

**stdin(0)/stdout(1)/stderr(2)**
* piping the output for cleaner output or if you want to see errors in log of the commmand you ran

*ignore errors*
* pipes to /dev/null which throws the errors out. good when i'm running ssearches with find and get a lot of permission denieds that i don't care about
> <any command\> 2>/dev/null

*write errors to a log file*
* example here with davtest it wouldn't write the errors that i also wanted to see this appends to the test.txt log file i run with the command
> davtest -url http://10.11.1.229:80/ >> test.txt 2>>test.txt

# CherryTree
* take quick effective notes paste stuff create documentation on hacked machines

> cherrytree

# Wget
* -r recursive
* -np for no parent
* download files recursively. This will create a tree structure of the path with the files inside

**Download all files in an HTTP directory**
> wget http://10.11.0.74/exploits/unix/CVE-2009-1894/ -r -np

**Download all files in an FTP directory**

> wget ftp://10.11.0.74/exploits/unix/CVE-2009-1894/* ---ftp-user=anonymous --ftp-password=""

# Bash Scripting
**Multiple commands in one line with IF/OR/AND type operators**
* https://askubuntu.com/questions/334994/which-one-is-better-using-or-to-execute-multiple-commands-in-one-line

**loop a subnet of ips for nslookup**
for i in $(seq 254); do nslookup 10.1.1.$i |grep -in name; done
**Check for empty args**
> https://stackoverflow.com/questions/6482377/check-existence-of-input-argument-in-a-bash-shell-script/6482403

**Loop through Each line in a file and do a command**
* IFC=\$'\n' will make the new line the seperator
* set -f  disable globbing/wildcard expansion ie; t*.txt normally returns test.txt but it wont with this param disabling it
* for i in \\$(ENTER COMMAND); capturing each line in my file to then do somethging with 
* do ENTER COMMAND \\$i; finally do something with each line masked as \$i var 
* done correctly end the script
IFS=$'\n'; set -f; for i in $(cat < "user.txt"); do echo "TESTING:$i"; doneIFS=$'\n'; set -f; for i in $(cat < "mariobros.lst"); do grep "$i" mariobroslist.txt; donefor i in $(seq 254); do ping 10.10.10.$i -c1 -W1 & done | grep from | awk '{print$4}'|cut -d ":" -f 1
**Combine/sort/uniq multiple lists**
* finds all .txt files in the "Web-Content" directory of type "file" and ending with ".txt" then sorts every line alphanumerically and only returns unique items in the EVERYTHING.txt file

> find /usr/share/seclists/Discovery/Web-Content/ -type f -name "*.txt" | xargs sort | uniq >> ./EVERYTHING.txt

# VIM
get used to it
 https://vim.rtorr.com/

**Most common commands**
* u - undo
* Ctrl + r  - redo
* wq - save and quit
* q! - quit without saving
* w - save without quitting
* h k j l - move cursor left,up,down,right respectively
* $ - go to end of line
* 0 - go to start of line
* x - delete/cut single character
* i - insert mode to insert new text/data etc
* gc - ask for confirmation
* %s - char replacement
* ^ - used to match the beginning of every line
* \$ - used to match then end of every line
    
**Delete word using pattern**

* deletes the word and replaces it with nothing in essence deleting it and "gc" asks for confirmation which is good when you might want to keep some
> %s/word//gc

**Block Comment code**
* https://stackoverflow.com/questions/1676632/whats-a-quick-way-to-comment-uncomment-lines-in-vim --- scroll past the accepted answer....

**Compare two files differences**
* useful to verify changes from one files aka fake code changed from original
> vimdiff 764.c OpenFuck.c

**Delete all Lines**
> "gg" go to first line
>  "dG" to delete all

**Add to the end of every line**
> ":" "%s/$/<your entry\>/gc

**Add to the start of every line**
>  ":" "%s/^/<your entry\>/gc

**Duplicate line**
* Copy line then Paste after end of line
> "Y" + "p"


# Services
* can use start,restart,reload(configs),status,stop as the last operator
> service <service name\> status

* alternative method to start/restart a service
>/etc/init.d/ssh reload

# Networking


## Netstat

## tcpkill
* Use reset packets to kill a connection in case the pid kills ffails
* host being the remote host your talking to
* -i is the interface to listen on
> tcpkill -i tap0 host 10.11.1.24

# BurpSuite

**Start burp**
* this starts it with a java option to take care of ssl passthrough issues it was having when processsing a https page
* https://www.zjulian.com/mitigating-burp-suite-error-burpsuite-handshake-alert-unrecognized_name
> java -Djsse.enableSNIExtension=false -jar /usr/bin/burpsuite 

# Disk Usage

> df -h
